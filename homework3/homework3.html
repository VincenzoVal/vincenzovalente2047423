---
layout: default
title: The RSA Cipher, Encryption and Frequency Analysis
---

<h2>The RSA Cipher: An Asymmetric Cryptosystem</h2>
<p>
The <strong>RSA (Rivest–Shamir–Adleman) cipher</strong> is a public-key cryptosystem and one of the first and most widely used systems for secure data transmission. 
RSA uses a pair of keys: a <strong>public key</strong> for encryption and a <strong>private key</strong> for decryption (asymmetric).
</p>
<p>
The security of RSA relies on the computational difficulty of factoring large integers—specifically, finding the two large prime factors of a very large composite number. 
For this demonstration, we’ll use small primes to make the math manageable.
</p>

<hr>

<h2>RSA Key Generation Steps</h2>
<ol>
    <li><strong>Choose two distinct prime numbers, p and q</strong> (e.g., p=13, q=17).</li>
    <li><strong>Compute the modulus N = p * q</strong></li>
    <li><strong>Compute Euler's totient φ(N) = (p - 1) * (q - 1)</strong></li>
    <li><strong>Choose the public exponent e</strong> such that gcd(e, φ(N)) = 1.</li>
    <li><strong>Compute the private key d</strong> such that (e × d) ≡ 1 (mod φ(N)).</li>
</ol>

<hr>

<h2>Interactive RSA Cipher Tool</h2>

<div style="display: flex; gap: 20px; align-items: flex-end; margin-bottom: 20px;">
    <div>
        <label><strong>Prime p:</strong></label><br>
        <input type="number" id="p_input" value="13" style="width: 100%;">
        <button id="generatePButton" style="width: 100%; margin-top: 5px;">Generate p</button>
    </div>
    <div>
        <label><strong>Prime q:</strong></label><br>
        <input type="number" id="q_input" value="17" style="width: 100%;">
        <button id="generateQButton" style="width: 100%; margin-top: 5px;">Generate q</button>
    </div>
    <div>
        <label><strong>Public Key e:</strong></label><br>
        <input type="number" id="e_input" value="11" style="width: 100%;">
    </div>
</div>

<div style="margin-top: 10px;">
    <textarea id="plaintextInput" rows="4" style="width: 100%;" placeholder="Enter your message..."></textarea>
</div>

<div style="margin-top: 10px;">
    <button id="encryptButton">Encrypt & Analyze</button>
    <button id="showEncryptCodeButton" style="margin-left: 10px;">Show Encrypt Code</button>
    <button id="showDecryptCodeButton" style="margin-left: 10px;">Show Decrypt Code</button>
    <button id="showHelperCodeButton" style="margin-left: 10px;">Show Helper Functions</button>
</div>

<div id="encryptCodeBox" style="display:none; background:#f8f8f8; border:1px solid #ccc; padding:10px; margin-top:10px;">
    <pre><code id="encryptCodeContent"></code></pre>
</div>

<div id="decryptCodeBox" style="display:none; background:#f8f8f8; border:1px solid #ccc; padding:10px; margin-top:10px;">
    <pre><code id="decryptCodeContent"></code></pre>
</div>

<div id="helperCodeBox" style="display:none; background:#f8f8f8; border:1px solid #ccc; padding:10px; margin-top:10px;">
    <pre><code id="helperCodeContent"></code></pre>
</div>

<div style="margin-top: 15px;">
    <label><strong>Ciphertext Output:</strong></label><br>
    <textarea id="ciphertextOutput" rows="4" style="width: 100%;" readonly></textarea>
</div>

<p style="margin-top: 15px;">
    <strong>Modulus N:</strong> <span id="modulusN">(Click Encrypt)</span>
</p>

<p>
    <strong>Private Key d:</strong> <span id="privateD">(Click Encrypt)</span>
</p>

<script>
document.addEventListener("DOMContentLoaded", () => {

    // ------------------------
    // Helper Functions
    // ------------------------
    function isPrime(num) {
        if (num < 2) return false;
        for (let i = 2; i <= Math.sqrt(num); i++) {
            if (num % i === 0) return false;
        }
        return true;
    }

    function gcd(a, b) {
        return b === 0 ? a : gcd(b, a % b);
    }

    function modInverse(e, phi) {
        let [a, b, x0, x1] = [phi, e, 0, 1];
        while (b !== 0) {
            let q = Math.floor(a / b);
            [a, b, x0, x1] = [b, a % b, x1 - q * x0, x0];
        }
        return (x1 + phi) % phi;
    }

    function letterDistribution(str) {
        const freq = {};
        const letters = str.toLowerCase().replace(/[^a-z]/g, "");
        for (const char of letters) freq[char] = (freq[char] || 0) + 1;
        const total = letters.length;
        const dist = {};
        for (const [char, count] of Object.entries(freq)) {
            dist[char] = ((count / total) * 100).toFixed(2);
        }
        return dist;
    }

    function cipherDistribution(cipherArray) {
        const freq = {};
        for (const val of cipherArray) freq[val] = (freq[val] || 0) + 1;
        const total = cipherArray.length;
        const dist = {};
        for (const [num, count] of Object.entries(freq)) {
            dist[num] = ((count / total) * 100).toFixed(2);
        }
        return dist;
    }

    // ------------------------
    // RSA Functions
    // ------------------------
    function rsaEncryptArray(text, e, n) {
        const lower = String(text).toLowerCase().replace(/[^a-z]/g, "");
        const ciphertext = [];
        for (const char of lower) {
            const m = char.charCodeAt(0);
            const c = (BigInt(m) ** BigInt(e)) % BigInt(n);
            ciphertext.push(c.toString());
        }
        return ciphertext;
    }

    function rsaDecryptArray(cipherArray, d, n) {
        const text = [];
        for (const val of cipherArray) {
            const m = (BigInt(val) ** BigInt(d)) % BigInt(n);
            text.push(String.fromCharCode(Number(m)));
        }
        return text.join("");
    }

    function decryptByDistribution(cipherDist, plainDist, cipherArray) {
        const sortedPlain = Object.entries(plainDist).sort((a, b) => parseFloat(b[1]) - parseFloat(a[1]));
        const sortedCipher = Object.entries(cipherDist).sort((a, b) => parseFloat(b[1]) - parseFloat(a[1]));
        const map = {};
        for (let i = 0; i < Math.min(sortedPlain.length, sortedCipher.length); i++) {
            const [plainChar] = sortedPlain[i];
            const [cipherVal] = sortedCipher[i];
            map[cipherVal] = plainChar;
        }
        let decryptedText = "";
        for (const val of cipherArray) decryptedText += map[val] || "?";
        return { decryptedText };
    }

    // ------------------------
    // Buttons to generate primes
    // ------------------------
    document.getElementById("generatePButton").addEventListener("click", () => {
        let prime;
        do {
            prime = Math.floor(Math.random() * 100) + 2;
        } while (!isPrime(prime));
        document.getElementById("p_input").value = prime;
    });

    document.getElementById("generateQButton").addEventListener("click", () => {
        let prime;
        do {
            prime = Math.floor(Math.random() * 100) + 2;
        } while (!isPrime(prime));
        document.getElementById("q_input").value = prime;
    });

    // ------------------------
    // Encrypt button
    // ------------------------
    document.getElementById("encryptButton").addEventListener("click", () => {
        const p = parseInt(document.getElementById("p_input").value);
        const q = parseInt(document.getElementById("q_input").value);
        const e = parseInt(document.getElementById("e_input").value);
        const plaintext = document.getElementById("plaintextInput").value;

        if (!isPrime(p) || !isPrime(q)) {
            alert("p and q must be prime numbers!");
            return;
        }

        const N = p * q;
        const phi = (p - 1) * (q - 1);

        if (gcd(e, phi) !== 1) {
            alert("e must be coprime with φ(N)");
            return;
        }

        const d = modInverse(e, phi);

        document.getElementById("modulusN").innerText = N;
        document.getElementById("privateD").innerText = d;

        const cipherArray = rsaEncryptArray(plaintext, e, N);
        document.getElementById("ciphertextOutput").value = cipherArray.join(" ");

        const plainFreq = letterDistribution(plaintext);
        const cipherFreq = cipherDistribution(cipherArray);

        const attackResult = decryptByDistribution(cipherFreq, plainFreq, cipherArray);
        document.getElementById("decryptedTextAttackOutput")?.value = attackResult.decryptedText;
    });

    // ------------------------
    // Show Code Buttons
    // ------------------------
    document.getElementById("showEncryptCodeButton").addEventListener("click", () => {
        const code = `
function rsaEncryptArray(text, e, n) {
    const lower = String(text).toLowerCase().replace(/[^a-z]/g, "");
    const ciphertext = [];
    for (const char of lower) {
        const m = char.charCodeAt(0);
        const c = (BigInt(m) ** BigInt(e)) % BigInt(n);
        ciphertext.push(c.toString());
    }
    return ciphertext;
}`;
        const box = document.getElementById("encryptCodeBox");
        document.getElementById("encryptCodeContent").textContent = code;
        box.style.display = box.style.display === "block" ? "none" : "block";
    });

    document.getElementById("showDecryptCodeButton").addEventListener("click", () => {
        const code = `
function rsaDecryptArray(cipherArray, d, n) {
    const text = [];
    for (const val of cipherArray) {
        const m = (BigInt(val) ** BigInt(d)) % BigInt(n);
        text.push(String.fromCharCode(Number(m)));
    }
    return text.join("");
}`;
        const box = document.getElementById("decryptCodeBox");
        document.getElementById("decryptCodeContent").textContent = code;
        box.style.display = box.style.display === "block" ? "none" : "block";
    });

    document.getElementById("showHelperCodeButton").addEventListener("click", () => {
        const code = `
// Helper functions
function isPrime(num) {
    if (num < 2) return false;
    for (let i = 2; i <= Math.sqrt(num); i++) {
        if (num % i === 0) return false;
    }
    return true;
}

function gcd(a, b) {
    return b === 0 ? a : gcd(b, a % b);
}

function modInverse(e, phi) {
    let [a, b, x0, x1] = [phi, e, 0, 1];
    while (b !== 0) {
        let q = Math.floor(a / b);
        [a, b, x0, x1] = [b, a % b, x1 - q * x0, x0];
    }
    return (x1 + phi) % phi;
}

function letterDistribution(str) {
    const freq = {};
    const letters = str.toLowerCase().replace(/[^a-z]/g, "");
    for (const char of letters) freq[char] = (freq[char] || 0) + 1;
    const total = letters.length;
    const dist = {};
    for (const [char, count] of Object.entries(freq)) {
        dist[char] = ((count / total) * 100).toFixed(2);
    }
    return dist;
}

function cipherDistribution(cipherArray) {
    const freq = {};
    for (const val of cipherArray) freq[val] = (freq[val] || 0) + 1;
    const total = cipherArray.length;
    const dist = {};
    for (const [num, count] of Object.entries(freq)) {
        dist[num] = ((count / total) * 100).toFixed(2);
    }
    return dist;
}`;
        const box = document.getElementById("helperCodeBox");
        document.getElementById("helperCodeContent").textContent = code;
        box.style.display = box.style.display === "block" ? "none" : "block";
    });

});
</script>
